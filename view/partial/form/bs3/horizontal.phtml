<?php
$class = sprintf('form-horizontal %s',$form->getAttribute('class'));
$form->setAttribute ( 'class', $class );
$form->prepare ();
$colunms = 12 - $labelColunms;
$options = ['label_colunms' => $labelColunms, 'element_colunms' => $colunms];
?>

<?= $this->form()->openTag($form)?>
<?php foreach ($form->getElements() as $element): ?>
	<?= $this->simpleFormRow($element, $options) ?>
<?php endforeach; //FIXME is there a better way to handle fieldsets? maybe should we use a recursive solution? ?>
<?php
//FIXME use as method on helper
function renderFieldsets($fieldsets, $obj, $options){
    foreach ($fieldsets as $fieldset){
        foreach ($fieldset->getElements() as $element){
    	   echo $obj->simpleFormRow($element, $options);
    	}
    	renderFieldsets($fieldset->getFieldsets(), $obj, $options);
    }
}
?>
<?php /*foreach ($form->getFieldsets() as $fieldset): ?>
    <?php foreach ($fieldset->getElements() as $element): ?>
    	<?= $this->simpleFormRow($element) ?>
    <?php endforeach; ?>
<?php endforeach; */
renderFieldsets($form->getFieldsets(), $this, $options)?>

<?php $submitLabel = isset($submitText)?$submitText:'Salvar'; ?>
	<div class="form-group">
		<div class="col-lg-offset-<?= $labelColunms ?> col-lg-<?= $colunms ?>">
			<button class="btn btn-success" type="submit"><?= $submitLabel ?></button>
			<button class="btn btn-warning" type="button" data-dismiss="modal">Cancelar</button>
		</div>
	</div>
<?= $this->form()->closeTag()?>